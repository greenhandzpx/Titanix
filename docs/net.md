### 内核接收分组

#### 旧的API

- 每次一个以太网帧到达时，都使用一个IRQ通知内核，内核随即将其放入cpu的等待队列中并发出软中断
- 如果网卡设备接收数据过快，会导致“中断风暴”

#### NAPI

- 处理过程：
    - 第一个分组到达时发出IRQ，然后驱动程序关闭该适配器的Rx IRQ，并将该适配器放在轮询表中
    - 内核对轮询表上的设备不断轮询直至没有数据
    - 重新开启IRQ
- 轮询表：
    - 通过一个链表组织所有的设备
    - 每个设备有一个权重，限制了读取的最大数据量
    - 