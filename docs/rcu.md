## RCU

### 基本内容

E1 --> E2 --> E3
       E2'

- 基本思想就是写的时候先拷贝一份内存再写，写完再修改指针
- 需要注意修改指针的次序，为了防止编译器优化，需要添加内存序限制

### 何时释放旧的版本的内存

- 读者在读旧版本期间不能进行上下文切换
- 写者一直等到每个核心都进行了一次上下文切换才释放旧版本内存